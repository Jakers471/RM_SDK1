# risk-daemon/pytest.ini
[pytest]
# Only look for tests in *this* repo (prevents discovering SDK tests)
testpaths = tests

# Naming patterns pytest should treat as tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Async support (pytest-asyncio)
asyncio_mode = auto

# Basic CLI logging (you can turn this off if too chatty)
log_cli = True
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Extra options (feel free to remove --verbose later)
addopts = --verbose --strict-markers

# Custom markers for selective runs
markers =
    unit: fast unit tests (no network)
    integration: uses real SDK connection (opt-in)
    performance: perf tests (opt-in)
    realtime: requires real-time connections (opt-in)
    p0: Priority 0 tests (critical functionality - MaxContracts, DailyLoss, etc)
    p1: Priority 1 tests (important functionality)
    p2: Priority 2 tests (nice to have)
    e2e: End-to-end tests (full system flows)

# Coverage thresholds (85% for core/ and rules/)
[coverage:run]
source = src
omit =
    */tests/*
    */conftest.py
    */__pycache__/*
    */venv/*
    */.venv/*

[coverage:report]
precision = 2
show_missing = True
skip_covered = False
fail_under = 85
